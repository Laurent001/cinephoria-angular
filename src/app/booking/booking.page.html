<app-layout
  *ngIf="booking$ | async as booking"
  [pageTitle]="'booking' | translate"
>
  <ion-content>
    <ion-list>
      <ion-item>
        <ion-grid>
          <ion-row>
            <ion-col
              size="12"
              size-xl="2"
              size-lg="3"
              size-md="3"
              size-sm="4"
              size-xs="6"
            >
              <ion-thumbnail>
                <img
                  class="film-poster"
                  [src]="booking?.film?.poster"
                  alt="Affiche du film"
                />
              </ion-thumbnail>
            </ion-col>
            <ion-col
              size="12"
              size-xl="10"
              size-lg="9"
              size-md="9"
              size-sm="8"
              size-xs="6"
            >
              <ion-card>
                <ion-card-header>
                  <ion-card-title>{{ booking?.film?.title }}</ion-card-title>
                  <ion-card-subtitle>
                    {{ booking?.film?.release_date | date:'dd MMMM yyyy' }} | {{
                    booking?.film?.genres }}<br />
                    Âge minimum : {{ booking?.film?.age_minimum }}+
                  </ion-card-subtitle>
                </ion-card-header>
                <ion-card-content>
                  {{ booking?.film?.description }}
                  <app-slider
                    [screenings]="booking.screenings"
                    (screeningSelected)="onScreeningSelected($event)"
                  ></app-slider>
                </ion-card-content>

                <ion-card-content
                  class="screening-selected"
                  *ngIf="screeningSelected"
                >
                  <h4>{{'booking-current' | translate}} :</h4>
                  <app-screening
                    [screening]="screeningSelected"
                    [seatsSelected]="seatsSelected"
                    [totalPrice]="totalPrice"
                  ></app-screening>
                  <ion-button
                    type="submit"
                    [disabled]="seatsSelected.length===0"
                    (click)="onBookingButton()"
                  >
                    {{'screening-booking' | translate}}
                  </ion-button>
                </ion-card-content>
              </ion-card>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col
              size="12"
              size-xl="2"
              size-lg="3"
              size-md="3"
              size-sm="4"
              size-xs="6"
            >
              <ion-card-header>
                <ion-card-title>Légende</ion-card-title>
              </ion-card-header>
            </ion-col>
            <ion-col
              size="12"
              size-xl="10"
              size-lg="9"
              size-md="9"
              size-sm="8"
              size-xs="6"
            >
              <ion-card>
                <ion-card-header>
                  <ion-card-title
                    >{{ 'seat-available' | translate }}</ion-card-title
                  >
                </ion-card-header>
                <ion-card-content
                  *ngIf="seats$ | async as seats"
                  class="seats-container"
                >
                  <app-seat
                    *ngFor="let seat of seats.seats"
                    [seat]="seat"
                    [isSelected]="isSeatSelected(seat)"
                    class="seat-item"
                    (click)="onSeatSelected(seat)"
                  ></app-seat>
                </ion-card-content>
              </ion-card>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-item>
    </ion-list>
  </ion-content>
</app-layout>
